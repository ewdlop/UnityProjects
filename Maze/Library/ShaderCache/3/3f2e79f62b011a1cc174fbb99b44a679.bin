

    /// <summary><para>
    ///    Provides support for ip configuation information and statistics.
    ///</para></summary>     
    ///
namespace System.Net.NetworkInformation {
    using System.Net.Sockets;
    using System;
    using System.ComponentModel;


    internal enum IcmpV6StatType {
        DestinationUnreachable          =   1,
        PacketTooBig       =   2,
        TimeExceeded        =   3,
        ParameterProblem           =   4,
        EchoRequest         = 128,
        EchoReply           = 129,
        MembershipQuery     = 130,
        MembershipReport    = 131,
        MembershipReduction = 132,
        RouterSolicit          = 133,
        RouterAdvertisement           = 134,
        NeighborSolict        = 135,
        NeighborAdvertisement         = 136,
        Redirect                = 137,
    };


       
    /// <summary>Icmp statistics for Ipv6.</summary>
    internal class SystemIcmpV6Statistics:IcmpV6Statistics {

        MibIcmpInfoEx stats;

        internal SystemIcmpV6Statistics(){

            uint result = UnsafeNetInfoNativeMethods.GetIcmpStatisticsEx(out stats,AddressFamily.InterNetworkV6);

            if (result != IpHelperErrors.Success) {
                throw new NetworkInformationException((int)result);
            }
        }

        public override long MessagesSent{get {return (long)stats.outStats.dwMsgs;}}
        public override long MessagesReceived{get {return (long)stats.inStats.dwMsgs;}}
        public override long ErrorsSent{get {return (long)stats.outStats.dwErrors;}}
        public override long ErrorsReceived{get {return (long)stats.inStats.dwErrors;}}
        public override long Destin