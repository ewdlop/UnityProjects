             loader.ExpandEntityReference(this);
                
            }
        }

        internal override void SetParentForLoad( XmlNode node ) {
         this.SetParent(  node );
        }

        internal override XmlLinkedNode LastNode {
            get { 
                return lastChild;
            }
            set { lastChild = value;}
        }

        internal override bool IsValidChildType( XmlNodeType type ) {
            switch (type) {
                case XmlNodeType.Element:
                case XmlNodeType.Text:
                case XmlNodeType.EntityReference:
                case XmlNodeType.Comment:
                case XmlNodeType.Whitespace:
                case XmlNodeType.SignificantWhitespace:
                case XmlNodeType.ProcessingInstruction:
                case XmlNodeType.CDATA:
                    return true;

                default:
                    return false;
            }
        }

        // Saves the node to the specified XmlWriter.
        public override void WriteTo(XmlWriter w) {
            w.WriteEntityRef(name);
        }

        // Saves all the children of the node to the specified XmlWriter.
        public override void WriteContentTo(XmlWriter w) {
            // -- eventually will the fix. commented out waiting for finalizing on the issue.
            foreach( XmlNode n in this ) {
                n.WriteTo( w );
            } //still use the old code to generate the output
            /*
            foreach( XmlNode n in this ) {
   